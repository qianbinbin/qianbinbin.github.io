<!doctype html><html lang=zh><meta charset=utf-8><meta name=generator content="Hugo 0.136.2"><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><meta name=color-scheme content="light dark"><meta name=supported-color-schemes content="light dark"><link rel=icon href=/favicons/favicon.svg><title>交叉编译 Go 语言项目 frp for iOS&nbsp;&ndash;&nbsp;Binac</title><link rel=stylesheet href=/css/core.min.d30edcc615d78b7f8a2a9e5f1b66bd074a7ad2e94b579fa5902d0967ce0f7684b300ef3a9e15d41af82c75f3fb951d4b.css integrity=sha384-0w7cxhXXi3+KKp5fG2a9B0p60ulLV5+lkC0JZ84PdoSzAO86nhXUGvgsdfP7lR1L><meta name=twitter:card content="summary">
<meta name=twitter:title content="交叉编译 Go 语言项目 frp for iOS"><body><section id=header><div class="header wrap"><span class="header left-side"><a class="site home" href=/><img class="site logo" src=/favicons/favicon.svg alt><span class="site name">Binac</span></a></span>
<span class="header right-side"><div class="nav wrap"><nav class=nav><a class='nav item active' href=/posts/ title=文章>文章</a>
<a class='nav item' href=/nonsense/ title=妄言>妄言</a>
<a class='nav item' href=/tuya/ title=涂鸦>涂鸦</a>
<a class='nav item' href=/tags/ title>标签</a></nav></div></span></div></section><section id=content><div class=article-container><section class="article header"><h1 class="article title">交叉编译 Go 语言项目 frp for iOS</h1><p class="article date">2019-09-03</p></section><article class="article markdown-body"><p>首先安装 Go 语言环境，然后下载 frp 源码：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>git clone git@github.com:fatedier/frp.git
</span></span><span class=line><span class=cl><span class=nb>cd</span> frp
</span></span></code></pre></div><p>Go 的交叉编译比 GCC、Clang 方便很多，只需要设置几个参数：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=nv>CC</span><span class=o>=</span><span class=nv>$GOPATH</span>/misc/ios/clangwrap.sh <span class=nv>CGO_ENABLED</span><span class=o>=</span><span class=m>1</span> <span class=nv>GOOS</span><span class=o>=</span>darwin <span class=nv>GOARCH</span><span class=o>=</span>arm64 go build -o ./frpc-darwin-arm64 ./cmd/frpc
</span></span><span class=line><span class=cl><span class=nv>CC</span><span class=o>=</span><span class=nv>$GOPATH</span>/misc/ios/clangwrap.sh <span class=nv>CGO_ENABLED</span><span class=o>=</span><span class=m>1</span> <span class=nv>GOOS</span><span class=o>=</span>darwin <span class=nv>GOARCH</span><span class=o>=</span>arm64 go build -o ./frps-darwin-arm64 ./cmd/frps
</span></span></code></pre></div><p><code>GOOS</code> 参数没什么疑问，<code>GOARCH</code> 不是太古老的设备一般都是 <code>arm64</code>。</p><p><code>CC</code> 一定要设置正确，<code>CGO_ENABLED</code> 不能像其他平台那样设置为 <code>0</code>，否则会有类似这样的错误：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># github.com/fatedier/frp/cmd/frps</span>
</span></span><span class=line><span class=cl><span class=nv>$GOPATH</span>/pkg/tool/darwin_amd64/link: running /misc/ios/clangwrap.sh failed: fork/exec /misc/ios/clangwrap.sh: no such file or directory
</span></span></code></pre></div><p>如果遇到网络问题：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>go: golang.org/x/net@v0.0.0-20190724013045-ca1201d0de80: unrecognized import path <span class=s2>&#34;golang.org/x/net&#34;</span> <span class=o>(</span>https fetch: Get https://golang.org/x/net?go-get<span class=o>=</span>1: dial tcp 216.239.37.1:443: i/o timeout<span class=o>)</span>
</span></span><span class=line><span class=cl>go: golang.org/x/text@v0.3.2: unrecognized import path <span class=s2>&#34;golang.org/x/text&#34;</span> <span class=o>(</span>https fetch: Get https://golang.org/x/text?go-get<span class=o>=</span>1: dial tcp 216.239.37.1:443: i/o timeout<span class=o>)</span>
</span></span><span class=line><span class=cl>go: error loading module requirements
</span></span></code></pre></div><p>说明是被墙了。代理方法没用，VPN 应该有效。</p><p>建议直接下载 Github 上的镜像源码放到对应目录，如：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>git clone git@github.com:golang/text.git <span class=nv>$GOPATH</span>/src/golang.org/x/text
</span></span></code></pre></div><p>然后重新编译即可。别忘了将编译生成的二进制文件进行签名。</p><h2 id=参考资料>参考资料</h2><ol><li><a href=https://shockerli.net/post/go-get-golang-org-x-solution/ target=_blank rel="noopener noreferrer">一键解决 go get golang.org/x 包失败 - 格物</a></li><li><a href=http://www.iikira.com/2017/08/09/golang-compile-jc-1/ target=_blank rel="noopener noreferrer">Golang教程：编译可在苹果iOS设备上运行的Go语言程序 | Konica 的自留地</a></li></ol></article><section class="article labels"><a class=tag href=/tags/ios/>iOS</a><a class=tag href=/tags/go/>Go</a><a class=tag href=/tags/%E4%BA%A4%E5%8F%89%E7%BC%96%E8%AF%91/>交叉编译</a></section><section class="article license"><p xmlns:cc=http://creativecommons.org/ns# style=text-align:center>本作品根据 <a href=http://creativecommons.org/licenses/by-nc-sa/4.0/ target=_blank rel="license noopener noreferrer" style=display:inline-block>署名-非商业性使用-相同方式共享 4.0 国际许可<img style=height:15px!important;margin-left:1px;vertical-align:text-bottom src=/cc-icons/cc.svg><img style=height:15px!important;margin-left:1px;vertical-align:text-bottom src=/cc-icons/by.svg><img style=height:15px!important;margin-left:1px;vertical-align:text-bottom src=/cc-icons/nc.svg><img style=height:15px!important;margin-left:1px;vertical-align:text-bottom src=/cc-icons/sa.svg></a> 进行授权。</p></section></div><div class="article bottom"><section class="article navigation"><p><a class=link href=/posts/cross-compile-samba-for-ios/><span class="iconfont icon-article"></span>移植 Samba 到 iOS 平台</a></p><p><a class=link href=/posts/perfect-squares/><span class="iconfont icon-article"></span>将正整数表示为若干平方数之和 Perfect Squares</a></p></section><section class="article discussion"><script>function loadComment(){let e=document.createElement("script");e.src="https://utteranc.es/client.js",e.setAttribute("repo","qianbinbin/qianbinbin.github.io"),e.setAttribute("issue-term","pathname"),e.setAttribute("theme","preferred-color-scheme"),e.setAttribute("crossorigin","anonymous"),e.setAttribute("async",""),document.querySelector("section.article.discussion").innerHTML="",document.querySelector("section.article.discussion").appendChild(e)}loadComment(),window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",()=>{loadComment()})</script></section></div></section><section id=footer><div class=footer-wrap><p class=copyright>© 2017-2024 Binac.</p></div></section><script async src="https://www.googletagmanager.com/gtag/js?id=G-N7VZY53PLB"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-N7VZY53PLB")}</script><script src=https://unpkg.com/vanilla-back-to-top@7.2.1/dist/vanilla-back-to-top.min.js></script><script>addBackToTop({diameter:42})</script></body></html>