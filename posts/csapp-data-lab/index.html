<!doctype html><html lang=zh><meta charset=utf-8><meta name=generator content="Hugo 0.136.2"><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><meta name=color-scheme content="light dark"><meta name=supported-color-schemes content="light dark"><link rel=icon href=/favicons/favicon.svg><title>CSAPP Data Lab&nbsp;&ndash;&nbsp;Binac</title><link rel=stylesheet href=/css/core.min.d30edcc615d78b7f8a2a9e5f1b66bd074a7ad2e94b579fa5902d0967ce0f7684b300ef3a9e15d41af82c75f3fb951d4b.css integrity=sha384-0w7cxhXXi3+KKp5fG2a9B0p60ulLV5+lkC0JZ84PdoSzAO86nhXUGvgsdfP7lR1L><meta name=twitter:card content="summary">
<meta name=twitter:title content="CSAPP Data Lab"><body><section id=header><div class="header wrap"><span class="header left-side"><a class="site home" href=/><img class="site logo" src=/favicons/favicon.svg alt><span class="site name">Binac</span></a></span>
<span class="header right-side"><div class="nav wrap"><nav class=nav><a class='nav item active' href=/posts/ title=文章>文章</a>
<a class='nav item' href=/nonsense/ title=妄言>妄言</a>
<a class='nav item' href=/tuya/ title=涂鸦>涂鸦</a>
<a class='nav item' href=/tags/ title>标签</a></nav></div></span></div></section><section id=content><div class=article-container><section class="article header"><h1 class="article title">CSAPP Data Lab</h1><p class="article date">2020-07-02</p></section><article class="article markdown-body"><p>Data Lab 的题<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>，第一眼觉得不难，仔细一看发现限制非常严格，比如只允许部分位运算符等，难度一下子就上去了，所以花了不少时间。</p><p><code>dlc</code> 是 64 位 Linux 程序，使用 <code>./dlc bits.c</code> 来检查是否符合限制条件。但 <code>Makefile</code> 里却指定了 <code>-m32</code>，可能是考虑到 C 标准只规定 <code>int</code> 至少为 16 位，一些环境可能会生成非 32 位的 <code>int</code>。</p><p>Debian 系 64 位 Linux 发行版可以安装：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ sudo apt install build-essential gcc-multilib g++-multilib
</span></span></code></pre></div><p>后两个库用于在 64 位环境下编译 32 位程序。</p><p>编译并运行测试程序：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ make clean <span class=o>&amp;&amp;</span> make btest <span class=o>&amp;&amp;</span> ./btest
</span></span></code></pre></div><h2 id=bitxor>bitXor</h2><p>用 <code>~</code> 和 <code>&</code> 来实现 <code>^</code>：</p><figure style="margin:0 0 1.5em"><figcaption style=text-align:right><a href=/code/csapp-labs/datalab-handout/bits.c style=color:lightslategrey;font-size:.8em>datalab-handout/bits.c</a></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=cm>/* 
</span></span></span><span class=line><span class=cl><span class=cm> * bitXor - x^y using only ~ and &amp; 
</span></span></span><span class=line><span class=cl><span class=cm> *   Example: bitXor(4, 5) = 1
</span></span></span><span class=line><span class=cl><span class=cm> *   Legal ops: ~ &amp;
</span></span></span><span class=line><span class=cl><span class=cm> *   Max ops: 14
</span></span></span><span class=line><span class=cl><span class=cm> *   Rating: 1
</span></span></span><span class=line><span class=cl><span class=cm> */</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>bitXor</span><span class=p>(</span><span class=kt>int</span> <span class=n>x</span><span class=p>,</span> <span class=kt>int</span> <span class=n>y</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=o>~</span><span class=p>(</span><span class=o>~</span><span class=p>(</span><span class=n>x</span> <span class=o>&amp;</span> <span class=o>~</span><span class=n>y</span><span class=p>)</span> <span class=o>&amp;</span> <span class=o>~</span><span class=p>(</span><span class=o>~</span><span class=n>x</span> <span class=o>&amp;</span> <span class=n>y</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></figure><p>根据</p><p>$$A \oplus{B} = A \cdot \overline{B} + \overline{A} \cdot B$$</p><p>来实现 <code>^</code>，再根据</p><p>$$A + B = \overline{\overline{A + B}} = \overline{\overline{A} \cdot \overline{B}}$$</p><p>来实现 <code>|</code>。</p><h2 id=tmin>tmin</h2><p>求补码最小值，送分题：</p><figure style="margin:0 0 1.5em"><figcaption style=text-align:right><a href=/code/csapp-labs/datalab-handout/bits.c style=color:lightslategrey;font-size:.8em>datalab-handout/bits.c</a></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=cm>/* 
</span></span></span><span class=line><span class=cl><span class=cm> * tmin - return minimum two&#39;s complement integer 
</span></span></span><span class=line><span class=cl><span class=cm> *   Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt;
</span></span></span><span class=line><span class=cl><span class=cm> *   Max ops: 4
</span></span></span><span class=line><span class=cl><span class=cm> *   Rating: 1
</span></span></span><span class=line><span class=cl><span class=cm> */</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>tmin</span><span class=p>(</span><span class=kt>void</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=mi>31</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></figure><h2 id=istmax>isTmax</h2><p>判断是否为 <code>int</code> 最大值 <code>0x7fffffff</code>，只允许使用 <code>! ~ & ^ | +</code>：</p><figure style="margin:0 0 1.5em"><figcaption style=text-align:right><a href=/code/csapp-labs/datalab-handout/bits.c style=color:lightslategrey;font-size:.8em>datalab-handout/bits.c</a></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm> * isTmax - returns 1 if x is the maximum, two&#39;s complement number,
</span></span></span><span class=line><span class=cl><span class=cm> *     and 0 otherwise 
</span></span></span><span class=line><span class=cl><span class=cm> *   Legal ops: ! ~ &amp; ^ | +
</span></span></span><span class=line><span class=cl><span class=cm> *   Max ops: 10
</span></span></span><span class=line><span class=cl><span class=cm> *   Rating: 1
</span></span></span><span class=line><span class=cl><span class=cm> */</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>isTmax</span><span class=p>(</span><span class=kt>int</span> <span class=n>x</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// If x is 0x7fffffff or 0xffffffff, then i is 1, else 0
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=o>!</span><span class=p>(</span><span class=o>~</span><span class=n>x</span> <span class=o>^</span> <span class=p>(</span><span class=n>x</span> <span class=o>+</span> <span class=mi>1</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=c1>// If x == 0xffffffff, then !~x is 1, else 0
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>return</span> <span class=n>i</span> <span class=o>&amp;</span> <span class=o>!!~</span><span class=n>x</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></figure><p>先将问题转化为判断是否为最大值的取反 <code>0x80000000</code>。</p><p>利用补码的特性，<code>int</code> 类型可以用取反加一来实现求相反数，而只有两个数满足与自身的相反数相等，即 <code>0</code> 和 <code>0x80000000</code>，其中后者是因为溢出。</p><p>再利用逻辑非 <code>!</code> 排除 <code>0</code> 即可。</p><h2 id=alloddbits>allOddBits</h2><p>判断是否所有奇数位（最低位为 0 位）都为 <code>1</code>：</p><figure style="margin:0 0 1.5em"><figcaption style=text-align:right><a href=/code/csapp-labs/datalab-handout/bits.c style=color:lightslategrey;font-size:.8em>datalab-handout/bits.c</a></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=cm>/* 
</span></span></span><span class=line><span class=cl><span class=cm> * allOddBits - return 1 if all odd-numbered bits in word set to 1
</span></span></span><span class=line><span class=cl><span class=cm> *   where bits are numbered from 0 (least significant) to 31 (most significant)
</span></span></span><span class=line><span class=cl><span class=cm> *   Examples allOddBits(0xFFFFFFFD) = 0, allOddBits(0xAAAAAAAA) = 1
</span></span></span><span class=line><span class=cl><span class=cm> *   Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt;
</span></span></span><span class=line><span class=cl><span class=cm> *   Max ops: 12
</span></span></span><span class=line><span class=cl><span class=cm> *   Rating: 2
</span></span></span><span class=line><span class=cl><span class=cm> */</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>allOddBits</span><span class=p>(</span><span class=kt>int</span> <span class=n>x</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>mask</span> <span class=o>=</span> <span class=mh>0xaa</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>mask</span> <span class=o>=</span> <span class=p>(</span><span class=n>mask</span> <span class=o>&lt;&lt;</span> <span class=mi>8</span><span class=p>)</span> <span class=o>|</span> <span class=n>mask</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>mask</span> <span class=o>=</span> <span class=p>(</span><span class=n>mask</span> <span class=o>&lt;&lt;</span> <span class=mi>16</span><span class=p>)</span> <span class=o>|</span> <span class=n>mask</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=o>!</span><span class=p>((</span><span class=n>x</span> <span class=o>&amp;</span> <span class=n>mask</span><span class=p>)</span> <span class=o>^</span> <span class=n>mask</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></figure><p>只允许使用 <code>0</code> 到 <code>0xff</code> 之间的常数，故先用移位求 <code>0xaaaaaaaa</code>，再用 <code>^</code> 实现 <code>==</code>。</p><h2 id=negate>negate</h2><p>求相反数，送分题：</p><figure style="margin:0 0 1.5em"><figcaption style=text-align:right><a href=/code/csapp-labs/datalab-handout/bits.c style=color:lightslategrey;font-size:.8em>datalab-handout/bits.c</a></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=cm>/* 
</span></span></span><span class=line><span class=cl><span class=cm> * negate - return -x 
</span></span></span><span class=line><span class=cl><span class=cm> *   Example: negate(1) = -1.
</span></span></span><span class=line><span class=cl><span class=cm> *   Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt;
</span></span></span><span class=line><span class=cl><span class=cm> *   Max ops: 5
</span></span></span><span class=line><span class=cl><span class=cm> *   Rating: 2
</span></span></span><span class=line><span class=cl><span class=cm> */</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>negate</span><span class=p>(</span><span class=kt>int</span> <span class=n>x</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=o>~</span><span class=n>x</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></figure><h2 id=isasciidigit>isAsciiDigit</h2><p>判断是否为 <code>'0'</code> 到 <code>'9'</code> 之间的 ASCII 码：</p><figure style="margin:0 0 1.5em"><figcaption style=text-align:right><a href=/code/csapp-labs/datalab-handout/bits.c style=color:lightslategrey;font-size:.8em>datalab-handout/bits.c</a></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=cm>/* 
</span></span></span><span class=line><span class=cl><span class=cm> * isAsciiDigit - return 1 if 0x30 &lt;= x &lt;= 0x39 (ASCII codes for characters &#39;0&#39; to &#39;9&#39;)
</span></span></span><span class=line><span class=cl><span class=cm> *   Example: isAsciiDigit(0x35) = 1.
</span></span></span><span class=line><span class=cl><span class=cm> *            isAsciiDigit(0x3a) = 0.
</span></span></span><span class=line><span class=cl><span class=cm> *            isAsciiDigit(0x05) = 0.
</span></span></span><span class=line><span class=cl><span class=cm> *   Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt;
</span></span></span><span class=line><span class=cl><span class=cm> *   Max ops: 15
</span></span></span><span class=line><span class=cl><span class=cm> *   Rating: 3
</span></span></span><span class=line><span class=cl><span class=cm> */</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>isAsciiDigit</span><span class=p>(</span><span class=kt>int</span> <span class=n>x</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mh>0x30</span><span class=p>,</span> <span class=n>result</span><span class=p>,</span> <span class=n>mask</span> <span class=o>=</span> <span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=mi>31</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=c1>// x - 0x30 &gt;= 0
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>result</span> <span class=o>=</span> <span class=o>!</span><span class=p>((</span><span class=n>x</span> <span class=o>+</span> <span class=o>~</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>&amp;</span> <span class=n>mask</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>i</span> <span class=o>=</span> <span class=mh>0x39</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 0x39 - x &gt;= 0
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>result</span> <span class=o>=</span> <span class=n>result</span> <span class=o>&amp;</span> <span class=o>!</span><span class=p>((</span><span class=n>i</span> <span class=o>+</span> <span class=o>~</span><span class=n>x</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span> <span class=o>&amp;</span> <span class=n>mask</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>result</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></figure><p>用求相反数和 <code>+</code> 来实现 <code>-</code>，再取符号位判断其正负。</p><p>中间可能有溢出的问题，当 <code>x - 0x30 >= 0</code> 时，可能 <code>x</code> 是一个很小的负数，负负得正产生溢出；当 <code>0x39 - x >= 0</code> 时，不会产生溢出，从而把前一种溢出的情况排除。</p><h2 id=conditional>conditional</h2><p>实现三元运算符 <code>a ? b : c</code>：</p><figure style="margin:0 0 1.5em"><figcaption style=text-align:right><a href=/code/csapp-labs/datalab-handout/bits.c style=color:lightslategrey;font-size:.8em>datalab-handout/bits.c</a></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=cm>/* 
</span></span></span><span class=line><span class=cl><span class=cm> * conditional - same as x ? y : z 
</span></span></span><span class=line><span class=cl><span class=cm> *   Example: conditional(2,4,5) = 4
</span></span></span><span class=line><span class=cl><span class=cm> *   Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt;
</span></span></span><span class=line><span class=cl><span class=cm> *   Max ops: 16
</span></span></span><span class=line><span class=cl><span class=cm> *   Rating: 3
</span></span></span><span class=line><span class=cl><span class=cm> */</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>conditional</span><span class=p>(</span><span class=kt>int</span> <span class=n>x</span><span class=p>,</span> <span class=kt>int</span> <span class=n>y</span><span class=p>,</span> <span class=kt>int</span> <span class=n>z</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// x = 0xffffffff or 0
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>x</span> <span class=o>=</span> <span class=o>~!!</span><span class=n>x</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>(</span><span class=n>y</span> <span class=o>&amp;</span> <span class=n>x</span><span class=p>)</span> <span class=o>|</span> <span class=p>(</span><span class=n>z</span> <span class=o>&amp;</span> <span class=o>~</span><span class=n>x</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></figure><p>将非零数转换为掩码 <code>0xffffffff</code>，零转换为掩码 <code>0</code>。</p><h2 id=islessorequal>isLessOrEqual</h2><p>实现 <code>&lt;=</code>：</p><figure style="margin:0 0 1.5em"><figcaption style=text-align:right><a href=/code/csapp-labs/datalab-handout/bits.c style=color:lightslategrey;font-size:.8em>datalab-handout/bits.c</a></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=cm>/* 
</span></span></span><span class=line><span class=cl><span class=cm> * isLessOrEqual - if x &lt;= y  then return 1, else return 0 
</span></span></span><span class=line><span class=cl><span class=cm> *   Example: isLessOrEqual(4,5) = 1.
</span></span></span><span class=line><span class=cl><span class=cm> *   Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt;
</span></span></span><span class=line><span class=cl><span class=cm> *   Max ops: 24
</span></span></span><span class=line><span class=cl><span class=cm> *   Rating: 3
</span></span></span><span class=line><span class=cl><span class=cm> */</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>isLessOrEqual</span><span class=p>(</span><span class=kt>int</span> <span class=n>x</span><span class=p>,</span> <span class=kt>int</span> <span class=n>y</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>mask</span> <span class=o>=</span> <span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=mi>31</span><span class=p>,</span> <span class=n>x_sign</span> <span class=o>=</span> <span class=o>!!</span><span class=p>(</span><span class=n>x</span> <span class=o>&amp;</span> <span class=n>mask</span><span class=p>),</span> <span class=n>y_sign</span> <span class=o>=</span> <span class=o>!!</span><span class=p>(</span><span class=n>y</span> <span class=o>&amp;</span> <span class=n>mask</span><span class=p>),</span> <span class=n>same_sign</span><span class=p>,</span> <span class=n>le</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>same_sign</span> <span class=o>=</span> <span class=o>!</span><span class=p>(</span><span class=n>x_sign</span> <span class=o>^</span> <span class=n>y_sign</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>le</span> <span class=o>=</span> <span class=o>!</span><span class=p>((</span><span class=o>~</span><span class=n>x</span> <span class=o>+</span> <span class=mi>1</span> <span class=o>+</span> <span class=n>y</span><span class=p>)</span> <span class=o>&amp;</span> <span class=n>mask</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>(</span><span class=n>x_sign</span> <span class=o>&amp;</span> <span class=o>!</span><span class=n>y_sign</span><span class=p>)</span> <span class=o>|</span> <span class=p>(</span><span class=n>same_sign</span> <span class=o>&amp;</span> <span class=n>le</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></figure><p>问题转化为判断 <code>-x + y</code> 正负。</p><p>考虑溢出的问题，取 <code>x</code>、<code>y</code> 的符号位，不同号时直接判断，若同号再判断 <code>-x + y</code> 正负。</p><h2 id=logicalneg>logicalNeg</h2><p>实现逻辑非 <code>!</code>：</p><figure style="margin:0 0 1.5em"><figcaption style=text-align:right><a href=/code/csapp-labs/datalab-handout/bits.c style=color:lightslategrey;font-size:.8em>datalab-handout/bits.c</a></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=cm>/* 
</span></span></span><span class=line><span class=cl><span class=cm> * logicalNeg - implement the ! operator, using all of 
</span></span></span><span class=line><span class=cl><span class=cm> *              the legal operators except !
</span></span></span><span class=line><span class=cl><span class=cm> *   Examples: logicalNeg(3) = 0, logicalNeg(0) = 1
</span></span></span><span class=line><span class=cl><span class=cm> *   Legal ops: ~ &amp; ^ | + &lt;&lt; &gt;&gt;
</span></span></span><span class=line><span class=cl><span class=cm> *   Max ops: 12
</span></span></span><span class=line><span class=cl><span class=cm> *   Rating: 4 
</span></span></span><span class=line><span class=cl><span class=cm> */</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>logicalNeg</span><span class=p>(</span><span class=kt>int</span> <span class=n>x</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// x = x | (x &gt;&gt; 1);
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// x = x | (x &gt;&gt; 2);
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// x = x | (x &gt;&gt; 4);
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// x = x | (x &gt;&gt; 8);
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// x = x | (x &gt;&gt; 16);
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// return ~x &amp; 1;
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=n>x</span> <span class=o>=</span> <span class=p>(</span><span class=n>x</span> <span class=o>|</span> <span class=p>(</span><span class=o>~</span><span class=n>x</span> <span class=o>+</span> <span class=mi>1</span><span class=p>))</span> <span class=o>&gt;&gt;</span> <span class=mi>31</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=o>~</span><span class=n>x</span> <span class=o>&amp;</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></figure><p>第一反应是将首个 <code>1</code> 之后的位全部置 <code>1</code>，若原值非零，则最低位为 <code>1</code>，否则为 <code>0</code>，然后将最低位直接取反即可。</p><p>后来发现了一种更简便的方法<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>，除 <code>0</code> 和 <code>0x80000000</code> 外，一个数必定与其相反数异号，若将 <code>x</code> 与 <code>-x</code> 符号异或，则包括 <code>0x80000000</code> 在内 ，所有非零数异或结果必定为 <code>1</code>。</p><h2 id=howmanybits>howManyBits</h2><p>求补码表示的最少位数：</p><figure style="margin:0 0 1.5em"><figcaption style=text-align:right><a href=/code/csapp-labs/datalab-handout/bits.c style=color:lightslategrey;font-size:.8em>datalab-handout/bits.c</a></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=cm>/* howManyBits - return the minimum number of bits required to represent x in
</span></span></span><span class=line><span class=cl><span class=cm> *             two&#39;s complement
</span></span></span><span class=line><span class=cl><span class=cm> *  Examples: howManyBits(12) = 5
</span></span></span><span class=line><span class=cl><span class=cm> *            howManyBits(298) = 10
</span></span></span><span class=line><span class=cl><span class=cm> *            howManyBits(-5) = 4
</span></span></span><span class=line><span class=cl><span class=cm> *            howManyBits(0)  = 1
</span></span></span><span class=line><span class=cl><span class=cm> *            howManyBits(-1) = 1
</span></span></span><span class=line><span class=cl><span class=cm> *            howManyBits(0x80000000) = 32
</span></span></span><span class=line><span class=cl><span class=cm> *  Legal ops: ! ~ &amp; ^ | + &lt;&lt; &gt;&gt;
</span></span></span><span class=line><span class=cl><span class=cm> *  Max ops: 90
</span></span></span><span class=line><span class=cl><span class=cm> *  Rating: 4
</span></span></span><span class=line><span class=cl><span class=cm> */</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>howManyBits</span><span class=p>(</span><span class=kt>int</span> <span class=n>x</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span> <span class=o>=</span> <span class=n>x</span> <span class=o>^</span> <span class=p>(</span><span class=n>x</span> <span class=o>&gt;&gt;</span> <span class=mi>31</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>n</span> <span class=o>=</span> <span class=n>n</span> <span class=o>+</span> <span class=p>((</span><span class=o>!!</span><span class=p>(</span><span class=n>x</span> <span class=o>&gt;&gt;</span> <span class=p>(</span><span class=n>n</span> <span class=o>+</span> <span class=mi>16</span><span class=p>)))</span> <span class=o>&lt;&lt;</span> <span class=mi>4</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>n</span> <span class=o>=</span> <span class=n>n</span> <span class=o>+</span> <span class=p>((</span><span class=o>!!</span><span class=p>(</span><span class=n>x</span> <span class=o>&gt;&gt;</span> <span class=p>(</span><span class=n>n</span> <span class=o>+</span> <span class=mi>8</span><span class=p>)))</span> <span class=o>&lt;&lt;</span> <span class=mi>3</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>n</span> <span class=o>=</span> <span class=n>n</span> <span class=o>+</span> <span class=p>((</span><span class=o>!!</span><span class=p>(</span><span class=n>x</span> <span class=o>&gt;&gt;</span> <span class=p>(</span><span class=n>n</span> <span class=o>+</span> <span class=mi>4</span><span class=p>)))</span> <span class=o>&lt;&lt;</span> <span class=mi>2</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>n</span> <span class=o>=</span> <span class=n>n</span> <span class=o>+</span> <span class=p>((</span><span class=o>!!</span><span class=p>(</span><span class=n>x</span> <span class=o>&gt;&gt;</span> <span class=p>(</span><span class=n>n</span> <span class=o>+</span> <span class=mi>2</span><span class=p>)))</span> <span class=o>&lt;&lt;</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>n</span> <span class=o>=</span> <span class=n>n</span> <span class=o>+</span> <span class=p>((</span><span class=o>!!</span><span class=p>(</span><span class=n>x</span> <span class=o>&gt;&gt;</span> <span class=p>(</span><span class=n>n</span> <span class=o>+</span> <span class=mi>1</span><span class=p>))));</span>
</span></span><span class=line><span class=cl>    <span class=n>n</span> <span class=o>=</span> <span class=n>n</span> <span class=o>+</span> <span class=p>(</span><span class=n>x</span> <span class=o>&gt;&gt;</span> <span class=n>n</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>n</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></figure><p>个人认为是最难的一题，参考了网上的答案<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>，并对其作了改进。</p><h3 id=如何确定最少位数>如何确定最少位数</h3><p>对于非负数而言，开头连续的 <code>0</code> 可以去掉，只需保留其中最后一个 <code>0</code> 作为符号位即可（否则就会被当成负数了）。例如，<code>0001...</code> 与 <code>01...</code> 表示的是相等值。</p><p>对于负数而言，同样从符号位开始，开头连续的 <code>1</code> 只需保留最后一个即可。例如，<code>1110...</code> 与 <code>10...</code> 表示的是相等值。</p><h3 id=将负数的情况转化为非负数的情况>将负数的情况转化为非负数的情况</h3><p><code>x = x ^ (x >> 31)</code> 的作用就是，若 <code>x</code> 为非负，则保持不变，若为负数，则取反。这样无论 <code>x</code> 符号，都可以按照非负数的情况来求解。</p><h3 id=求最高位的-1-到最低位的长度最终结果就是长度--1>求最高位的 <code>1</code> 到最低位的长度，最终结果就是长度 + 1</h3><p>这个步骤需要一些技巧。</p><p>例如，<code>01** **** **** **** **** **** **** ****</code> 的最高位 1 到最低位是 31 位，最终结果就是 32。</p><p>观察 31 = 16 + 8 + 4 + 2 + 1，与 <code>x</code> 右移试零的过程一致：首先取 <code>x</code> 最高 16 位，若非零，说明需要 16 位以上的位数，此时 <code>n</code> 计数 + 16，并将低 16 位去掉。接着尝试将低 8 位去掉，以此类推，直到 <code>x</code> 只剩一位。手动模拟一下会更容易理解。</p><p>上个步骤已经排除了负数的情况，所以无需担心算数右移高位产生 1 的问题。</p><pre tabindex=0><code>01** **** **** **** **** **** **** ****

n = 16

01** **** **** ****

n = 16 + 8

01** ****

n = 16 + 8 + 4

01**

n = 16 + 8 + 4 + 2

01

n = 16 + 8 + 4 + 2 + 0

01

n = 16 + 8 + 4 + 2 + 0 + 1
</code></pre><h2 id=floatscale2>floatScale2</h2><p>书上的习题，求 $2x$：</p><figure style="margin:0 0 1.5em"><figcaption style=text-align:right><a href=/code/csapp-labs/datalab-handout/bits.c style=color:lightslategrey;font-size:.8em>datalab-handout/bits.c</a></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=cm>/* 
</span></span></span><span class=line><span class=cl><span class=cm> * floatScale2 - Return bit-level equivalent of expression 2*f for
</span></span></span><span class=line><span class=cl><span class=cm> *   floating point argument f.
</span></span></span><span class=line><span class=cl><span class=cm> *   Both the argument and result are passed as unsigned int&#39;s, but
</span></span></span><span class=line><span class=cl><span class=cm> *   they are to be interpreted as the bit-level representation of
</span></span></span><span class=line><span class=cl><span class=cm> *   single-precision floating point values.
</span></span></span><span class=line><span class=cl><span class=cm> *   When argument is NaN, return argument
</span></span></span><span class=line><span class=cl><span class=cm> *   Legal ops: Any integer/unsigned operations incl. ||, &amp;&amp;. also if, while
</span></span></span><span class=line><span class=cl><span class=cm> *   Max ops: 30
</span></span></span><span class=line><span class=cl><span class=cm> *   Rating: 4
</span></span></span><span class=line><span class=cl><span class=cm> */</span>
</span></span><span class=line><span class=cl><span class=kt>unsigned</span> <span class=nf>floatScale2</span><span class=p>(</span><span class=kt>unsigned</span> <span class=n>uf</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>unsigned</span> <span class=n>sign</span> <span class=o>=</span> <span class=n>uf</span> <span class=o>&amp;</span> <span class=mh>0x80000000</span><span class=p>,</span> <span class=n>exp</span> <span class=o>=</span> <span class=n>uf</span> <span class=o>&amp;</span> <span class=mh>0x7f800000</span><span class=p>,</span> <span class=n>frac</span> <span class=o>=</span> <span class=n>uf</span> <span class=o>&amp;</span> <span class=mh>0x007fffff</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 0 or denorm
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=n>exp</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>sign</span> <span class=o>|</span> <span class=n>uf</span> <span class=o>&lt;&lt;</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=c1>// inf or NaN
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=n>exp</span> <span class=o>==</span> <span class=mh>0x7f800000</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>uf</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=c1>// norm
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>exp</span> <span class=o>+=</span> <span class=mh>0x00800000</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=c1>// large number becomes inf
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=n>exp</span> <span class=o>==</span> <span class=mh>0x7f800000</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>frac</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>sign</span> <span class=o>|</span> <span class=n>exp</span> <span class=o>|</span> <span class=n>frac</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></figure><p>浮点数题目的限制比前面宽松很多，虽然构造复杂一点，只要按照定义求解即可。</p><h2 id=floatfloat2int>floatFloat2Int</h2><p>书上的习题，<code>float</code> 转换为 <code>int</code>：</p><figure style="margin:0 0 1.5em"><figcaption style=text-align:right><a href=/code/csapp-labs/datalab-handout/bits.c style=color:lightslategrey;font-size:.8em>datalab-handout/bits.c</a></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=cm>/* 
</span></span></span><span class=line><span class=cl><span class=cm> * floatFloat2Int - Return bit-level equivalent of expression (int) f
</span></span></span><span class=line><span class=cl><span class=cm> *   for floating point argument f.
</span></span></span><span class=line><span class=cl><span class=cm> *   Argument is passed as unsigned int, but
</span></span></span><span class=line><span class=cl><span class=cm> *   it is to be interpreted as the bit-level representation of a
</span></span></span><span class=line><span class=cl><span class=cm> *   single-precision floating point value.
</span></span></span><span class=line><span class=cl><span class=cm> *   Anything out of range (including NaN and infinity) should return
</span></span></span><span class=line><span class=cl><span class=cm> *   0x80000000u.
</span></span></span><span class=line><span class=cl><span class=cm> *   Legal ops: Any integer/unsigned operations incl. ||, &amp;&amp;. also if, while
</span></span></span><span class=line><span class=cl><span class=cm> *   Max ops: 30
</span></span></span><span class=line><span class=cl><span class=cm> *   Rating: 4
</span></span></span><span class=line><span class=cl><span class=cm> */</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>floatFloat2Int</span><span class=p>(</span><span class=kt>unsigned</span> <span class=n>uf</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>sign</span> <span class=o>=</span> <span class=n>uf</span> <span class=o>&gt;&gt;</span> <span class=mi>31</span><span class=p>,</span> <span class=n>exp</span> <span class=o>=</span> <span class=p>((</span><span class=n>uf</span> <span class=o>&gt;&gt;</span> <span class=mi>23</span><span class=p>)</span> <span class=o>&amp;</span> <span class=mh>0xff</span><span class=p>)</span> <span class=o>-</span> <span class=mi>127</span><span class=p>,</span> <span class=n>frac</span> <span class=o>=</span> <span class=p>(</span><span class=n>uf</span> <span class=o>&amp;</span> <span class=mh>0x007fffff</span><span class=p>)</span> <span class=o>|</span> <span class=mh>0x00800000</span><span class=p>,</span> <span class=n>value</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>exp</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>exp</span> <span class=o>&gt;</span> <span class=mi>30</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=mh>0x80000000</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>exp</span> <span class=o>&lt;</span> <span class=mi>23</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>value</span> <span class=o>=</span> <span class=n>frac</span> <span class=o>&gt;&gt;</span> <span class=p>(</span><span class=mi>23</span> <span class=o>-</span> <span class=n>exp</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=n>exp</span> <span class=o>&gt;</span> <span class=mi>23</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>value</span> <span class=o>=</span> <span class=n>frac</span> <span class=o>&lt;&lt;</span> <span class=p>(</span><span class=n>exp</span> <span class=o>-</span> <span class=mi>23</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>sign</span> <span class=o>?</span> <span class=o>-</span><span class=nl>value</span> <span class=p>:</span> <span class=n>value</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></figure><p><code>float</code> 范围比 <code>int</code> 更广，但精度（有效数字）更低，注意溢出的情况。</p><h2 id=floatpower2>floatPower2</h2><p>书上的习题，求 $2^x$：</p><figure style="margin:0 0 1.5em"><figcaption style=text-align:right><a href=/code/csapp-labs/datalab-handout/bits.c style=color:lightslategrey;font-size:.8em>datalab-handout/bits.c</a></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=cm>/* 
</span></span></span><span class=line><span class=cl><span class=cm> * floatPower2 - Return bit-level equivalent of the expression 2.0^x
</span></span></span><span class=line><span class=cl><span class=cm> *   (2.0 raised to the power x) for any 32-bit integer x.
</span></span></span><span class=line><span class=cl><span class=cm> *
</span></span></span><span class=line><span class=cl><span class=cm> *   The unsigned value that is returned should have the identical bit
</span></span></span><span class=line><span class=cl><span class=cm> *   representation as the single-precision floating-point number 2.0^x.
</span></span></span><span class=line><span class=cl><span class=cm> *   If the result is too small to be represented as a denorm, return
</span></span></span><span class=line><span class=cl><span class=cm> *   0. If too large, return +INF.
</span></span></span><span class=line><span class=cl><span class=cm> * 
</span></span></span><span class=line><span class=cl><span class=cm> *   Legal ops: Any integer/unsigned operations incl. ||, &amp;&amp;. Also if, while 
</span></span></span><span class=line><span class=cl><span class=cm> *   Max ops: 30 
</span></span></span><span class=line><span class=cl><span class=cm> *   Rating: 4
</span></span></span><span class=line><span class=cl><span class=cm> */</span>
</span></span><span class=line><span class=cl><span class=kt>unsigned</span> <span class=nf>floatPower2</span><span class=p>(</span><span class=kt>int</span> <span class=n>x</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>x</span> <span class=o>&lt;</span> <span class=o>-</span><span class=mi>149</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=c1>// denorm
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=n>x</span> <span class=o>&lt;</span> <span class=o>-</span><span class=mi>126</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=p>(</span><span class=mi>149</span> <span class=o>+</span> <span class=n>x</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=c1>// norm
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=n>x</span> <span class=o>&lt;</span> <span class=mi>128</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>(</span><span class=n>x</span> <span class=o>+</span> <span class=mi>127</span><span class=p>)</span> <span class=o>&lt;&lt;</span> <span class=mi>23</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=c1>// inf
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>return</span> <span class=mh>0x7f800000</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></figure><h2 id=参考资料>参考资料</h2><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=http://csapp.cs.cmu.edu/3e/labs.html target=_blank rel="noopener noreferrer">CS:APP3e, Bryant and O&rsquo;Hallaron</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p><a href=https://zhuanlan.zhihu.com/p/82529114 target=_blank rel="noopener noreferrer">Introduction to CSAPP（八）：Datalab - 知乎</a>&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p><a href=http://claude-ray.com/2019/10/02/csapp-datalab/#howManyBits target=_blank rel="noopener noreferrer">CSAPP DataLab 题解 | Claude&rsquo;s Blog</a>&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></article><section class="article labels"><a class=tag href=/tags/csapp/>CSAPP</a><a class=tag href=/tags/%E7%AE%97%E6%B3%95/>算法</a><a class=tag href=/tags/%E4%BD%8D%E6%93%8D%E4%BD%9C/>位操作</a></section><section class="article license"><p xmlns:cc=http://creativecommons.org/ns# style=text-align:center>本作品根据 <a href=http://creativecommons.org/licenses/by-nc-sa/4.0/ target=_blank rel="license noopener noreferrer" style=display:inline-block>署名-非商业性使用-相同方式共享 4.0 国际许可<img style=height:15px!important;margin-left:1px;vertical-align:text-bottom src=/cc-icons/cc.svg><img style=height:15px!important;margin-left:1px;vertical-align:text-bottom src=/cc-icons/by.svg><img style=height:15px!important;margin-left:1px;vertical-align:text-bottom src=/cc-icons/nc.svg><img style=height:15px!important;margin-left:1px;vertical-align:text-bottom src=/cc-icons/sa.svg></a> 进行授权。</p></section></div><div class="article bottom"><section class="article navigation"><p><a class=link href=/posts/opencore-efi-for-lenovo-thinkcentre-m73-tiny-desktop/><span class="iconfont icon-article"></span>自制 OpenCore EFI 让联想 M73 Tiny 吃上黑苹果</a></p><p><a class=link href=/posts/shrink-disk-image/><span class="iconfont icon-article"></span>缩减 IMG 镜像文件</a></p></section><section class="article discussion"><script>function loadComment(){let e=document.createElement("script");e.src="https://utteranc.es/client.js",e.setAttribute("repo","qianbinbin/qianbinbin.github.io"),e.setAttribute("issue-term","pathname"),e.setAttribute("theme","preferred-color-scheme"),e.setAttribute("crossorigin","anonymous"),e.setAttribute("async",""),document.querySelector("section.article.discussion").innerHTML="",document.querySelector("section.article.discussion").appendChild(e)}loadComment(),window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",()=>{loadComment()})</script></section></div></section><section id=footer><div class=footer-wrap><p class=copyright>© 2017-2024 Binac.</p></div></section><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css integrity=sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.js integrity=sha384-YNHdsYkH6gMx9y3mRkmcJ2mFUjTd0qNQQvY9VYZgQd7DcN7env35GzlmFaZ23JGp crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/contrib/auto-render.min.js integrity=sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl crossorigin=anonymous></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],throwOnError:!1})})</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-N7VZY53PLB"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-N7VZY53PLB")}</script><script src=https://unpkg.com/vanilla-back-to-top@7.2.1/dist/vanilla-back-to-top.min.js></script><script>addBackToTop({diameter:42})</script></body></html>