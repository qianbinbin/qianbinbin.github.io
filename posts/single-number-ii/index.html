<!doctype html><html lang=zh><meta charset=utf-8><meta name=generator content="Hugo 0.136.2"><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><meta name=color-scheme content="light dark"><meta name=supported-color-schemes content="light dark"><link rel=icon href=/favicons/favicon.svg><title>Single Number II&nbsp;&ndash;&nbsp;Binac</title><link rel=stylesheet href=/css/core.min.d30edcc615d78b7f8a2a9e5f1b66bd074a7ad2e94b579fa5902d0967ce0f7684b300ef3a9e15d41af82c75f3fb951d4b.css integrity=sha384-0w7cxhXXi3+KKp5fG2a9B0p60ulLV5+lkC0JZ84PdoSzAO86nhXUGvgsdfP7lR1L><meta name=twitter:card content="summary">
<meta name=twitter:title content="Single Number II"><body><section id=header><div class="header wrap"><span class="header left-side"><a class="site home" href=/><img class="site logo" src=/favicons/favicon.svg alt><span class="site name">Binac</span></a></span>
<span class="header right-side"><div class="nav wrap"><nav class=nav><a class='nav item active' href=/posts/ title=文章>文章</a>
<a class='nav item' href=/nonsense/ title=妄言>妄言</a>
<a class='nav item' href=/tuya/ title=涂鸦>涂鸦</a>
<a class='nav item' href=/tags/ title>标签</a></nav></div></span></div></section><section id=content><div class=article-container><section class="article header"><h1 class="article title">Single Number II</h1><p class="article date">2017-11-27</p></section><article class="article markdown-body"><p>LeetCode 的一道题，在一个 int 数组中，其余数值均出现了 3 次，只有一个数值出现了 1 次，求这个数：
<a href=https://leetcode.com/problems/single-number-ii/description/ target=_blank rel="noopener noreferrer">https://leetcode.com/problems/single-number-ii/description/</a></p><blockquote><p>Given an array of integers, every element appears three times except for one, which appears exactly once. Find that single one.</p><p>Note:
Your algorithm should have a linear runtime complexity. Could you implement it without using extra memory?</p></blockquote><p>要求时间复杂度为 $O(n)$，并挑战读者是否能在空间复杂度 $O(1)$ 的条件下解决。</p><h2 id=哈希表法>哈希表法</h2><p>一种显而易见的方法就是用哈希表，但是空间复杂度为 $O(n)$。这里不做赘述。</p><h2 id=统计二进制位出现次数>统计二进制位出现次数</h2><p>对 int 整型数的每个二进制位，统计其在所有元素中出现的次数。出现次数有 3 种情况：</p><ol><li><p>为 0</p></li><li><p>为 3 的倍数</p></li><li><p>为 1</p></li></ol><p>我们只需要把出现次数模 3 后为 1 的位重新组合，就得到所求数值。</p><p>为此，我们可以定义一个长度为 int 类型比特位数，也就是<code>sizeof(int) * 8</code>长度的 int 数组，用来统计每个二进制位出现次数。</p><p>数组长度在特定机器上是固定的，因此空间复杂度为 $O(1)$。C 语言实现参考上面的链接。</p><h2 id=位操作法>位操作法</h2><p>在上面的方法中，用一个 int 数组来统计二进制位出现次数有点浪费，事实上在统计次数时，只需要考虑 3 种情况：0、1、2，当次数到达 3 时，将其重置为 0 即可，这其实是 3 进制运算。</p><p>要保存 3 种状态，只需要 2 个比特：</p><table><thead><tr><th>0</th><th>1</th><th>2</th></tr></thead><tbody><tr><td>00</td><td>01</td><td>10</td></tr></tbody></table><p>int 类型的每个比特需要 2 个比特保存状态，一个保存低位比特，一个保存高位比特，那么总共只需要 2 个 int 来保存。接下来要做的就是用 2 个比特模拟 3 进制运算。</p><h3 id=通过真值表写出逻辑表达式>通过真值表写出逻辑表达式</h3><p>设 A 表示低位，B 表示高位，C 表示当前统计的比特，列出真值表：</p><table><thead><tr><th>B A</th><th>C</th><th>B&rsquo;A'</th></tr></thead><tbody><tr><td>0 0</td><td>0</td><td>0 0</td></tr><tr><td>0 0</td><td>1</td><td>0 1</td></tr><tr><td>0 1</td><td>0</td><td>0 1</td></tr><tr><td>0 1</td><td>1</td><td>1 0</td></tr><tr><td>1 0</td><td>0</td><td>1 0</td></tr><tr><td>1 0</td><td>1</td><td>0 0</td></tr></tbody></table><p>先计算新的低位，逻辑表达式为</p><p>$$A&rsquo;=\overline{B} , \overline{A} , C + \overline{B} , A , \overline{C}
=(A\oplus{C}) , \overline{B}$$</p><p>在编码实现时，计算 A&rsquo; 覆盖了原先的 A，再计算 B&rsquo; 时就需要用 A&rsquo; 计算：</p><p>$$B&rsquo;=\overline{B} , C , \overline{A&rsquo;} + B , \overline{C} , \overline{A&rsquo;}
=(B\oplus{C}) , \overline{A&rsquo;}$$</p><p>用 C 语言编码为：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=kt>int</span> <span class=n>one</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=n>two</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>numsSize</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>one</span> <span class=o>=</span> <span class=p>(</span><span class=n>one</span> <span class=o>^</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>])</span> <span class=o>&amp;</span> <span class=o>~</span><span class=n>two</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>two</span> <span class=o>=</span> <span class=p>(</span><span class=n>two</span> <span class=o>^</span> <span class=n>nums</span><span class=p>[</span><span class=n>i</span><span class=p>])</span> <span class=o>&amp;</span> <span class=o>~</span><span class=n>one</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>最终的<code>one</code>恰好就是所求的数值，而<code>two</code>理论上为 0，因为根据题中条件不会有出现 2 次的情况。</p><h3 id=复杂度>复杂度</h3><p>时间复杂度为 $O(n)$，空间复杂度为 $O(1)$，只用了两个<code>int</code>。</p><h2 id=实现源码>实现源码</h2><p><a href=https://github.com/qianbinbin/leetcode target=_blank rel="noopener noreferrer">https://github.com/qianbinbin/leetcode</a></p><h2 id=参考资料>参考资料</h2><ol><li><a href=https://leetcode.com/problems/single-number-ii/discuss/43294/Challenge-me-thx target=_blank rel="noopener noreferrer">Single Number II - LeetCode</a></li></ol></article><section class="article labels"><a class=tag href=/tags/leetcode/>LeetCode</a><a class=tag href=/tags/%E7%AE%97%E6%B3%95/>算法</a><a class=tag href=/tags/%E4%BD%8D%E6%93%8D%E4%BD%9C/>位操作</a></section><section class="article license"><p xmlns:cc=http://creativecommons.org/ns# style=text-align:center>本作品根据 <a href=http://creativecommons.org/licenses/by-nc-sa/4.0/ target=_blank rel="license noopener noreferrer" style=display:inline-block>署名-非商业性使用-相同方式共享 4.0 国际许可<img style=height:15px!important;margin-left:1px;vertical-align:text-bottom src=/cc-icons/cc.svg><img style=height:15px!important;margin-left:1px;vertical-align:text-bottom src=/cc-icons/by.svg><img style=height:15px!important;margin-left:1px;vertical-align:text-bottom src=/cc-icons/nc.svg><img style=height:15px!important;margin-left:1px;vertical-align:text-bottom src=/cc-icons/sa.svg></a> 进行授权。</p></section></div><div class="article bottom"><section class="article navigation"><p><a class=link href=/posts/cycle-detection/><span class="iconfont icon-article"></span>Floyd 判圈算法</a></p><p><a class=link href=/posts/gas-station/><span class="iconfont icon-article"></span>Gas Station</a></p></section><section class="article discussion"><script>function loadComment(){let e=document.createElement("script");e.src="https://utteranc.es/client.js",e.setAttribute("repo","qianbinbin/qianbinbin.github.io"),e.setAttribute("issue-term","pathname"),e.setAttribute("theme","preferred-color-scheme"),e.setAttribute("crossorigin","anonymous"),e.setAttribute("async",""),document.querySelector("section.article.discussion").innerHTML="",document.querySelector("section.article.discussion").appendChild(e)}loadComment(),window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",()=>{loadComment()})</script></section></div></section><section id=footer><div class=footer-wrap><p class=copyright>© 2017-2024 Binac.</p></div></section><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css integrity=sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.js integrity=sha384-YNHdsYkH6gMx9y3mRkmcJ2mFUjTd0qNQQvY9VYZgQd7DcN7env35GzlmFaZ23JGp crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/contrib/auto-render.min.js integrity=sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl crossorigin=anonymous></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],throwOnError:!1})})</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-N7VZY53PLB"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-N7VZY53PLB")}</script><script src=https://unpkg.com/vanilla-back-to-top@7.2.1/dist/vanilla-back-to-top.min.js></script><script>addBackToTop({diameter:42})</script></body></html>