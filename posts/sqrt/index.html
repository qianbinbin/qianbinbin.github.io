<!doctype html><html lang=zh><meta charset=utf-8><meta name=generator content="Hugo 0.136.2"><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><meta name=color-scheme content="light dark"><meta name=supported-color-schemes content="light dark"><link rel=icon href=/favicons/favicon.svg><title>牛顿法实现开平方 sqrt&nbsp;&ndash;&nbsp;Binac</title><link rel=stylesheet href=/css/core.min.d30edcc615d78b7f8a2a9e5f1b66bd074a7ad2e94b579fa5902d0967ce0f7684b300ef3a9e15d41af82c75f3fb951d4b.css integrity=sha384-0w7cxhXXi3+KKp5fG2a9B0p60ulLV5+lkC0JZ84PdoSzAO86nhXUGvgsdfP7lR1L><meta name=twitter:card content="summary">
<meta name=twitter:title content="牛顿法实现开平方 sqrt"><body><section id=header><div class="header wrap"><span class="header left-side"><a class="site home" href=/><img class="site logo" src=/favicons/favicon.svg alt><span class="site name">Binac</span></a></span>
<span class="header right-side"><div class="nav wrap"><nav class=nav><a class='nav item active' href=/posts/ title=文章>文章</a>
<a class='nav item' href=/nonsense/ title=妄言>妄言</a>
<a class='nav item' href=/tuya/ title=涂鸦>涂鸦</a>
<a class='nav item' href=/tags/ title>标签</a></nav></div></span></div></section><section id=content><div class=article-container><section class="article header"><h1 class="article title">牛顿法实现开平方 sqrt</h1><p class="article date">2018-04-30</p></section><article class="article markdown-body"><p>在精度要求较低的情况下，可以用二分查找实现开平方，例如 <a href=https://leetcode.com/problems/sqrtx/ target=_blank rel="noopener noreferrer">Sqrt(x) - LeetCode</a> 就只需返回 <code>int</code>，即精确到个位。</p><p>在求更高精度开平方时，可以利用牛顿法。</p><h2 id=从泰勒公式到牛顿法>从泰勒公式到牛顿法</h2><p>泰勒公式</p><p>$$f(x) = f(x_0) + f&rsquo;(x_0)(x − x_0) + \frac{f&rsquo;&rsquo;(x_0)}{2!}(x − x_0)^2+ &mldr; + \frac{f^n(x_0)}{n!}(x − x_0)^n + R_n(x).$$</p><p>余项 $R_n(x)$ 为 $(x - x_x)^n$ 的高阶无穷小。</p><p>现求 $f(x) = 0$ 的根，取展开式的前两项 $f(x_0) + f&rsquo;(x_0)(x - x_0)$，取 $x_1$ 为一个比较接近根的值，令</p><p>$$f(x_1) + f&rsquo;(x_1)(x - x_1) = 0.$$</p><p>求得的解记为 $x_2$，通常 $x_2$ 会比 $x_1$ 更接近方程 $f(x) = 0$ 的解。</p><p>用 $x_2$ 代替方程中的 $x_1$，继续求出 $x_3, x_4, x_5, &mldr;$，每次迭代都得到更精确的解。</p><p>事实上，$y = f(x_0) + f&rsquo;(x_0)(x - x_0)$ 是 $y = f(x)$ 在 $x = x_0$ 的切线，切线与 $x$ 轴的交点横坐标比 $x_0$ 更接近 $y = f(x)$ 的零点。</p><p>借助维基百科的图片更容易理解：</p><p><img src=https://upload.wikimedia.org/wikipedia/commons/e/e0/NewtonIteration_Ani.gif alt></p><p>令</p><p>$$f(x_n) + f&rsquo;(x_n)(x_{n + 1} - x_n) = 0,$$</p><p>得迭代公式</p><p>$$ x_{n + 1} = x_n - \frac{f(x_n)}{f&rsquo;(x_n)}.$$</p><h2 id=开平方迭代公式>开平方迭代公式</h2><p>求开平方 $\sqrt{n}$，可令</p><p>$$x = \sqrt{n},$$</p><p>即求</p><p>$$x^2 - n = 0$$</p><p>的非负根。</p><p>设函数 $f(x) = x^2 - n$，$f&rsquo;(x) = 2x$，代入迭代公式化简得</p><p>$$x_{n + 1} = \frac{1}{2} (x_n + \frac{n}{x_n}).$$</p><p>在实现时可以设定一个允许的误差，不断迭代，一旦结果误差在允许之内就可以停止迭代。这就是牛顿法求开平方。</p><p>类似地还可以求更高次方根以及其它复杂方程的根。</p><h2 id=实现源码>实现源码</h2><p><a href=https://github.com/qianbinbin/leetcode target=_blank rel="noopener noreferrer">https://github.com/qianbinbin/leetcode</a></p><h2 id=参考资料>参考资料</h2><ol><li><a href=https://en.wikipedia.org/wiki/Newton%27s_method target=_blank rel="noopener noreferrer">Newton&rsquo;s method - Wikipedia</a></li></ol></article><section class="article labels"><a class=tag href=/tags/leetcode/>LeetCode</a><a class=tag href=/tags/%E7%AE%97%E6%B3%95/>算法</a></section><section class="article license"><p xmlns:cc=http://creativecommons.org/ns# style=text-align:center>本作品根据 <a href=http://creativecommons.org/licenses/by-nc-sa/4.0/ target=_blank rel="license noopener noreferrer" style=display:inline-block>署名-非商业性使用-相同方式共享 4.0 国际许可<img style=height:15px!important;margin-left:1px;vertical-align:text-bottom src=/cc-icons/cc.svg><img style=height:15px!important;margin-left:1px;vertical-align:text-bottom src=/cc-icons/by.svg><img style=height:15px!important;margin-left:1px;vertical-align:text-bottom src=/cc-icons/nc.svg><img style=height:15px!important;margin-left:1px;vertical-align:text-bottom src=/cc-icons/sa.svg></a> 进行授权。</p></section></div><div class="article bottom"><section class="article navigation"><p><a class=link href=/posts/best-time-to-buy-and-sell-stock-iii/><span class="iconfont icon-article"></span>Best Time to Buy and Sell Stock III</a></p><p><a class=link href=/posts/unique-binary-search-trees-ii/><span class="iconfont icon-article"></span>批量构建二叉查找树时的一个常见错误</a></p></section><section class="article discussion"><script>function loadComment(){let e=document.createElement("script");e.src="https://utteranc.es/client.js",e.setAttribute("repo","qianbinbin/qianbinbin.github.io"),e.setAttribute("issue-term","pathname"),e.setAttribute("theme","preferred-color-scheme"),e.setAttribute("crossorigin","anonymous"),e.setAttribute("async",""),document.querySelector("section.article.discussion").innerHTML="",document.querySelector("section.article.discussion").appendChild(e)}loadComment(),window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",()=>{loadComment()})</script></section></div></section><section id=footer><div class=footer-wrap><p class=copyright>© 2017-2024 Binac.</p></div></section><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css integrity=sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.js integrity=sha384-YNHdsYkH6gMx9y3mRkmcJ2mFUjTd0qNQQvY9VYZgQd7DcN7env35GzlmFaZ23JGp crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/contrib/auto-render.min.js integrity=sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl crossorigin=anonymous></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],throwOnError:!1})})</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-N7VZY53PLB"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-N7VZY53PLB")}</script><script src=https://unpkg.com/vanilla-back-to-top@7.2.1/dist/vanilla-back-to-top.min.js></script><script>addBackToTop({diameter:42})</script></body></html>